<ImportExportXml version="4.0.0.0" languagecode="1049" generatedBy="OnPremise">
  <Entities>
  </Entities>
  <Roles>
  </Roles>
  <Workflows>
  </Workflows>
  <IsvConfig>
    <configuration version="3.0.0000.0">
      <Root>
        <!-- 		Application Level Tool Bar, не удалять !		-->
      </Root>
      <Entities>
        <Entity name="account">
          <Grid>
            <MenuBar>
              <ActionsMenu>
                <MenuItem JavaScript="doIsvAction('crmGrid',true,'/../{0}/GroupOperation/ChangeTerritory/Client','1','dialogWidth:450px; dialogHeight:230px; status:yes; scroll:no; resizable:no; ');crmGrid.Refresh();">
                  <Titles>
                    <Title LCID="1049" Text="Сменить Территорию" />
                  </Titles>
                </MenuItem>
              </ActionsMenu>
              <Buttons>
                <Button Icon="/_imgs/ico_16_assign.gif" JavaScript="doIsvAction('crmGrid',true,'/../{0}/GroupOperation/Assign/Client','1','dialogHeight:300px; dialogWidth:650px; status:yes; scroll:no; resizable:no; ');crmGrid.Refresh();" Client="Web">
                  <Titles>
                    <Title LCID="1049" Text="Назначение" />
                  </Titles>
                  <ToolTips>
                    <ToolTip LCID="1049" Text="Сменить Куратора" />
                  </ToolTips>
                </Button>
                <Button Icon="/_imgs/ico_16_importCustomizations.gif" JavaScript="doIsvAction('crmGrid',true,'/../{0}/GroupOperation/Qualify/Client','1','dialogHeight:300px; dialogWidth:650px; status:yes; scroll:no; resizable:no; ');crmGrid.Refresh();" Client="Web">
                  <Titles>
                    <Title LCID="1049" Text="Взять из резерва" />
                  </Titles>
                  <ToolTips>
                    <ToolTip LCID="1049" Text="Забрать клиента из резерва" />
                  </ToolTips>
                </Button>
                <Button Icon="/_imgs/ico_16_exportCustomizations.gif" JavaScript="doIsvAction('crmGrid',true,'/../{0}/GroupOperation/Disqualify/Client','1','dialogHeight:230px; dialogWidth:650px; status:yes; scroll:no; resizable:no; ');crmGrid.Refresh();" Client="Web">
                  <Titles>
                    <Title LCID="1049" Text="Вернуть в резерв" />
                  </Titles>
                  <ToolTips>
                    <ToolTip LCID="1049" Text="Вернуть клиента в резерв" />
                  </ToolTips>
                </Button>
              </Buttons>
            </MenuBar>
          </Grid>
        </Entity>
        <Entity name="contact">
          <Grid>
            <MenuBar>
              <Buttons>
                <Button Icon="/_imgs/ico_16_assign.gif" JavaScript="doIsvAction('crmGrid',true,'/../{0}/GroupOperation/Assign/Contact','1','dialogHeight:300px; dialogWidth:650px; status:yes; scroll:no; resizable:no; ');crmGrid.Refresh();" Client="Web">
                  <Titles>
                    <Title LCID="1049" Text="Назначение" />
                  </Titles>
                  <ToolTips>
                    <ToolTip LCID="1049" Text="Сменить Куратора" />
                  </ToolTips>
                </Button>
              </Buttons>
            </MenuBar>
          </Grid>
        </Entity>
        <Entity name="opportunity">
          <Grid>
            <MenuBar>
              <Buttons>
                <Button Icon="/_imgs/ico_16_assign.gif" JavaScript="doIsvAction('crmGrid',true,'/../{0}/GroupOperation/Assign/Deal','1','dialogHeight:300px; dialogWidth:650px; status:yes; scroll:no; resizable:no; ');crmGrid.Refresh();" Client="Web">
                  <Titles>
                    <Title LCID="1049" Text="Назначение" />
                  </Titles>
                  <ToolTips>
                    <ToolTip LCID="1049" Text="Сменить Куратора" />
                  </ToolTips>
                </Button>
              </Buttons>
            </MenuBar>
          </Grid>
        </Entity>
        <Entity name="lead" />
        <Entity name="list" />
        <Entity name="campaign" />
        <Entity name="campaignactivity" />
        <Entity name="campaignresponse" />
        <Entity name="incident" />
        <!-- Case -->
        <Entity name="quote" />
        <Entity name="salesorder" />
        <!-- Order -->
        <Entity name="invoice" />
        <!-- Custom Entities -->
        <!-- <Entity name="new_myentity"/> -->
        <Entity name="dg_account">
          <Grid>
            <MenuBar>
              <ActionsMenu>
                <MenuItem Icon="/_imgs/ico_16_assign.gif" JavaScript="doIsvAction('crmGrid',true,'/../{0}/GroupOperation/Assign/Account','1','dialogHeight:300px; dialogWidth:650px; status:yes; scroll:no; resizable:no; ');crmGrid.Refresh();">
                  <Titles>
                    <Title LCID="1049" Text="Назначение" />
                  </Titles>
                </MenuItem>
                <MenuItem Icon="/_imgs/ico_18_4405.gif" JavaScript="doIsvAction('crmGrid',true,'/../{0}/Account/ExportTo1CDialog','1','dialogHeight:300px; dialogWidth:650px; status:yes; scroll:no; resizable:no; ');crmGrid.Refresh();">
                  <Titles>
                    <Title LCID="1049" Text="Выгрузка списаний" />
                  </Titles>
                </MenuItem>
              </ActionsMenu>
            </MenuBar>
          </Grid>
        </Entity>
        <Entity name="dg_bargain">
          <Grid>
            <MenuBar>
              <ActionsMenu>
                <MenuItem JavaScript="var selected=getSelected('crmGrid');doIsvAction('crmGrid',true,'/../{0}/Bargain/CloseBargains?Bargains='+selected,'1','dialogHeight:300px; dialogWidth:650px; status:yes; scroll:no; resizable:no; ');crmGrid.Refresh();">
                  <Titles>
                    <Title LCID="1049" Text="Закрыть действие договоров" />
                  </Titles>
                </MenuItem>
              </ActionsMenu>
            </MenuBar>
          </Grid>
        </Entity>
        <Entity name="dg_firm">
          <Grid>
            <MenuBar>
              <ActionsMenu>
                <MenuItem JavaScript="doIsvAction('crmGrid',true,'/../{0}/GroupOperation/Assign/Firm','1','dialogHeight:300px; dialogWidth:650px; status:yes; scroll:no; resizable:no; ');crmGrid.Refresh();">
                  <Titles>
                    <Title LCID="1049" Text="Сменить Куратора" />
                  </Titles>
                </MenuItem>
                <MenuItem JavaScript="doIsvAction('crmGrid',true,'/../{0}/GroupOperation/ChangeClient/Firm','1','dialogWidth:500px; dialogHeight:210px; status:yes; scroll:no; resizable:no; ');crmGrid.Refresh();">
                  <Titles>
                    <Title LCID="1049" Text="Сменить Клиента" />
                  </Titles>
                </MenuItem>
                <MenuItem JavaScript="doIsvAction('crmGrid',true,'/../{0}/GroupOperation/ChangeTerritory/Firm','1','dialogWidth:450px; dialogHeight:230px; status:yes; scroll:no; resizable:no; ');crmGrid.Refresh();">
                  <Titles>
                    <Title LCID="1049" Text="Сменить Территорию" />
                  </Titles>
                </MenuItem>
              </ActionsMenu>
              <Buttons>
                <Button Icon="/_imgs/ico_16_importCustomizations.gif" JavaScript="doIsvAction('crmGrid',true,'/../{0}/GroupOperation/Qualify/Firm','1','dialogHeight:430px; dialogWidth:650px; status:yes; scroll:no; resizable:no; ');crmGrid.Refresh();" Client="Web">
                  <Titles>
                    <Title LCID="1049" Text="Взять из резерва" />
                  </Titles>
                  <ToolTips>
                    <ToolTip LCID="1049" Text="Забрать фирму из резерва" />
                  </ToolTips>
                </Button>
                <Button Icon="/_imgs/ico_16_assign.gif" JavaScript="doIsvAction('crmGrid',true,'/../{0}/GroupOperation/Assign/Firm','1','dialogHeight:300px; dialogWidth:650px; status:yes; scroll:no; resizable:no; ');crmGrid.Refresh();" Client="Web">
                  <Titles>
                    <Title LCID="1049" Text="Назначение" />
                  </Titles>
                  <ToolTips>
                    <ToolTip LCID="1049" Text="Сменить Куратора" />
                  </ToolTips>
                </Button>
              </Buttons>
            </MenuBar>
          </Grid>
        </Entity>
        <Entity name="dg_limit">
          <Grid>
            <MenuBar>
              <ActionsMenu>
                <MenuItem JavaScript="var selected=getSelected('crmGrid');openIsvWin('/../{0}/Limit/CrmSetStatus?ReplicationCodes='+selected+'&amp;Status=1',true,'1','dialogHeight:250px; dialogWidth:650px; status:yes; scroll:no; resizable:no; ',selected);crmGrid.Refresh();">
                  <Titles>
                    <Title LCID="1049" Text="Отозвать" />
                  </Titles>
                </MenuItem>
                <MenuItem JavaScript="var selected=getSelected('crmGrid');openIsvWin('/../{0}/Limit/CrmSetStatus?ReplicationCodes='+selected+'&amp;Status=2',true,'1','dialogHeight:210px; dialogWidth:650px; status:yes; scroll:no; resizable:no; ',selected);crmGrid.Refresh();">
                  <Titles>
                    <Title LCID="1049" Text="Одобрить" />
                  </Titles>
                </MenuItem>
                <MenuItem JavaScript="var selected=getSelected('crmGrid');openIsvWin('/../{0}/Limit/CrmSetStatus?ReplicationCodes='+selected+'&amp;Status=3',true,'1','dialogHeight:210px; dialogWidth:650px; status:yes; scroll:no; resizable:no; ',selected);crmGrid.Refresh();">
                  <Titles>
                    <Title LCID="1049" Text="Отклонить" />
                  </Titles>
                </MenuItem>
                <MenuItem JavaScript="var ids=getAll('crmGrid');openIsvWin('/../{0}/Limit/PrintLimits?limits='+ids,true,'0','height=210px,width=650px,top=300px,left=300px',ids);crmGrid.Refresh();">
                  <Titles>
                    <Title LCID="1049" Text="Печать лимитов" />
                  </Titles>
                </MenuItem>
              </ActionsMenu>
            </MenuBar>
          </Grid>
        </Entity>
        <Entity name="dg_order">
          <Grid>
            <MenuBar>
              <ActionsMenu>
                <MenuItem JavaScript="openIsvWin('/../{0}/Order/CheckOrdersReadinessForReleaseDialog',true,'0','height=310px,width=530px,top=300px,left=300px');">
                  <Titles>
                    <Title LCID="1049" Text="Проверить заказы к сборке" />
                  </Titles>
                </MenuItem>
                <MenuItem JavaScript="openIsvWin('/../{0}/OrderDialogs/MakeRegionalAdsDocs',true,'0','height=280px,width=530px,top=300px,left=300px');">
                  <Titles>
                    <Title LCID="1049" Text="Сформировать региональные печатные формы" />
                  </Titles>
                </MenuItem>
              </ActionsMenu>
              <Buttons>
                <Button Icon="/_imgs/ico_16_delete.gif" JavaScript="var selected=getSelected('crmGrid');if (selected &amp;&amp; selected.length &amp;&amp; selected.length == 1){openIsvWin('/../{0}/Order/CrmCloseWithDenial/' + selected[0],true,'1','dialogHeight:250px; dialogWidth:650px; status:yes; scroll:no; resizable:no; ', { });crmGrid.Refresh();}else{alert('Для данной операции нужно выбрать только один элемент');}" Client="Web">
                  <Titles>
                    <Title LCID="1049" Text="Закрыть отказом" />
                  </Titles>
                </Button>
                <Button Icon="/_imgs/ico_16_assign.gif" JavaScript="doIsvAction('crmGrid',true,'/../{0}/GroupOperation/Assign/Order','1','dialogHeight:300px; dialogWidth:650px; status:yes; scroll:no; resizable:no; ');crmGrid.Refresh();" Client="Web">
                  <Titles>
                    <Title LCID="1049" Text="Назначение" />
                  </Titles>
                  <ToolTips>
                    <ToolTip LCID="1049" Text="Сменить Куратора" />
                  </ToolTips>
                </Button>
              </Buttons>
            </MenuBar>
          </Grid>
        </Entity>
        <Entity name="dg_legalperson">
          <Grid>
            <MenuBar>
              <Buttons>
                <Button Icon="/_imgs/ico/16_activate.gif" JavaScript="var selected=getSelected('crmGrid');openIsvWin('/../{0}/GroupOperation/Activate/LegalPerson',true,'1','dialogHeight:250px; dialogWidth:650px; status:yes; scroll:no; resizable:no; ', { 'Values': selected, 'DoSpecialConfirmation': false });crmGrid.Refresh();" Client="Web">
                  <ToolTips>
                    <ToolTip LCID="1049" Text="Восстановить" />
                  </ToolTips>
                </Button>
                <Button Icon="/_imgs/ico/16_deactivate.gif" JavaScript="var selected=getSelected('crmGrid');openIsvWin('/../{0}/GroupOperation/Deactivate/LegalPerson',true,'1','dialogHeight:250px; dialogWidth:650px; status:yes; scroll:no; resizable:no; ', { 'Values': selected, 'DoSpecialConfirmation': false });crmGrid.Refresh();" Client="Web">
                  <ToolTips>
                    <ToolTip LCID="1049" Text="Скрыть" />
                  </ToolTips>
                </Button>
                <Button Icon="/_imgs/ico_16_delete.gif" JavaScript="var selected=getSelected('crmGrid');openIsvWin('/../{0}/GroupOperation/Delete/LegalPerson',true,'1','dialogHeight:250px; dialogWidth:650px; status:yes; scroll:no; resizable:no; ', { 'Values': selected, 'DoSpecialConfirmation': true });crmGrid.Refresh();" Client="Web">
                  <ToolTips>
                    <ToolTip LCID="1049" Text="Удалить" />
                  </ToolTips>
                </Button>
                <Button Icon="/_imgs/ico_16_assign.gif" JavaScript="doIsvAction('crmGrid',true,'/../{0}/GroupOperation/Assign/LegalPerson','1','dialogHeight:300px; dialogWidth:650px; status:yes; scroll:no; resizable:no; ');crmGrid.Refresh();" Client="Web">
                  <Titles>
                    <Title LCID="1049" Text="Назначение" />
                  </Titles>
                  <ToolTips>
                    <ToolTip LCID="1049" Text="Сменить Куратора" />
                  </ToolTips>
                </Button>
                <Button Icon="/_imgs/ico_16_merge.gif" JavaScript="var selected=getSelected('crmGrid');&#xD;&#xA;                        if (selected &amp;&amp; selected.length &amp;&amp; selected.length == 1)&#xD;&#xA;                        {&#xD;&#xA;                        openIsvWin('/../{0}/LegalPerson/CrmMerge?crmId='+selected[0],false,'1','dialogHeight:210px; dialogWidth:650px; status:yes; scroll:no; resizable:no; ',selected);&#xD;&#xA;                        }&#xD;&#xA;                        else if (selected &amp;&amp; selected.length &amp;&amp; selected.length == 2)&#xD;&#xA;                        {&#xD;&#xA;                        openIsvWin('/../{0}/LegalPerson/CrmMerge?crmId='+selected[0]+'&amp;appendedId='+selected[1],false,'1','dialogHeight:210px; dialogWidth:650px; status:yes; scroll:no; resizable:no; ',selected);&#xD;&#xA;                        }&#xD;&#xA;                        else&#xD;&#xA;                        {&#xD;&#xA;                        alert('Для операции слияния нужно выбрать один или два элемента');&#xD;&#xA;                        }&#xD;&#xA;                        crmGrid.Refresh();">
                  <Titles>
                    <Title LCID="1049" Text="Слияние" />
                  </Titles>
                  <ToolTips>
                    <ToolTip LCID="1049" Text="Слияние юр. лиц" />
                  </ToolTips>
                </Button>
              </Buttons>
            </MenuBar>
          </Grid>
        </Entity>
        <Entity name="task">
          <!-- The Account Tool Bar -->
          <ToolBar ValidForCreate="0" ValidForUpdate="1">
            <Button Icon="/_imgs/ico/16_deactivate.gif" JavaScript="&#xA;ExecuteWorkflow = function(entityId, workflowId)&#xA;{&#xA;    var xml = &quot;&quot; + &#xA;    &quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;utf-8\&quot;?&gt;&quot; + &#xA;    &quot;&lt;soap:Envelope xmlns:soap=\&quot;http://schemas.xmlsoap.org/soap/envelope/\&quot; xmlns:xsi=\&quot;http://www.w3.org/2001/XMLSchema-instance\&quot; xmlns:xsd=\&quot;http://www.w3.org/2001/XMLSchema\&quot;&gt;&quot; + &#xA;    GenerateAuthenticationHeader() +&#xA;    &quot;  &lt;soap:Body&gt;&quot; + &#xA;    &quot;    &lt;Execute xmlns=\&quot;http://schemas.microsoft.com/crm/2007/WebServices\&quot;&gt;&quot; + &#xA;    &quot;      &lt;Request xsi:type=\&quot;ExecuteWorkflowRequest\&quot;&gt;&quot; + &#xA;    &quot;        &lt;EntityId&gt;&quot; + entityId + &quot;&lt;/EntityId&gt;&quot; + &#xA;    &quot;        &lt;WorkflowId&gt;&quot; + workflowId + &quot;&lt;/WorkflowId&gt;&quot; + &#xA;    &quot;      &lt;/Request&gt;&quot; + &#xA;    &quot;    &lt;/Execute&gt;&quot; + &#xA;    &quot;  &lt;/soap:Body&gt;&quot; + &#xA;    &quot;&lt;/soap:Envelope&gt;&quot; + &#xA;    &quot;&quot;;&#xA;&#xA;    var xmlHttpRequest = new ActiveXObject(&quot;Msxml2.XMLHTTP&quot;);&#xA;    xmlHttpRequest.Open(&quot;POST&quot;, &quot;/mscrmservices/2007/CrmService.asmx&quot;, false);&#xA;    xmlHttpRequest.setRequestHeader(&quot;SOAPAction&quot;,&quot;http://schemas.microsoft.com/crm/2007/WebServices/Execute&quot;);&#xA;    xmlHttpRequest.setRequestHeader(&quot;Content-Type&quot;, &quot;text/xml; charset=utf-8&quot;);&#xA;    xmlHttpRequest.setRequestHeader(&quot;Content-Length&quot;, xml.length);&#xA;    xmlHttpRequest.send(xml);&#xA;    var resultXml = xmlHttpRequest.responseXML;&#xA;    return(resultXml.selectSingleNode('//soap:Envelope/soap:Body/ExecuteResponse/Response/Id').nodeTypedValue);&#xA;}&#xA;&#xA;WaitWorkflowExecution = function(workflowId)&#xA;{&#xA;    var xml = &quot;&lt;?xml version='1.0' encoding='utf-8'?&gt;&quot;+ &#xA;    &quot;&lt;soap:Envelope xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'&quot;+&#xA;    &quot; xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'&quot;+&#xA;    &quot; xmlns:xsd='http://www.w3.org/2001/XMLSchema'&gt;&quot;+ &#xA;    GenerateAuthenticationHeader() +&#xA;    &quot;&lt;soap:Body&gt;&quot;+ &#xA;    &quot;&lt;Retrieve xmlns='http://schemas.microsoft.com/crm/2007/WebServices'&gt;&quot;+ &#xA;    &quot;&lt;entityName&gt;asyncoperation&lt;/entityName&gt;&quot;+ &#xA;    &quot;&lt;id&gt;&quot;+workflowId+&quot;&lt;/id&gt;&quot;+ &#xA;    &quot;&lt;columnSet xmlns:q1='http://schemas.microsoft.com/crm/2006/Query' xsi:type='q1:ColumnSet'&gt;&quot;+ &#xA;    &quot;&lt;q1:Attributes&gt;&quot;+ &#xA;    &quot;&lt;q1:Attribute&gt;statuscode&lt;/q1:Attribute&gt;&quot;+ &#xA;    &quot;&lt;/q1:Attributes&gt;&quot;+ &#xA;    &quot;&lt;/columnSet&gt;&quot;+ &#xA;    &quot;&lt;/Retrieve&gt;&quot;+ &#xA;    &quot;&lt;/soap:Body&gt;&quot;+ &#xA;    &quot;&lt;/soap:Envelope&gt;&quot;;&#xA;&#xA;    var xHReq = new ActiveXObject(&quot;Msxml2.XMLHTTP&quot;);&#xA;    xHReq.Open(&quot;POST&quot;, &quot;/mscrmservices/2007/CrmService.asmx&quot;, false);&#xA;    xHReq.setRequestHeader(&quot;SOAPAction&quot;,&quot;http://schemas.microsoft.com/crm/2007/WebServices/Retrieve&quot;);&#xA;    xHReq.setRequestHeader(&quot;Content-Type&quot;, &quot;text/xml; charset=utf-8&quot;);&#xA;    xHReq.setRequestHeader(&quot;Content-Length&quot;, xml.length);&#xA;    xHReq.send(xml);&#xA;    var resultXml = xHReq.responseXML;&#xA;&#xA;    var errorCount = resultXml.selectNodes('//error').length;&#xA;    if (errorCount != 0)&#xA;    {&#xA; // alert(xHReq.responseText + xHReq.status + xHReq.statusText);&#xA;        setTimeout(&quot;WaitWorkflowExecution('&quot; + workflowId + &quot;');&quot;, 1000);&#xA;    }&#xA;    else&#xA;    {&#xA;        var executionstatus = resultXml.selectSingleNode(&quot;//soap:Envelope/soap:Body/RetrieveResponse/RetrieveResult/q1:statuscode&quot;).nodeTypedValue;&#xA;    &#xA;&#xA;        if (executionstatus == 30)//Workflow completed&#xA;        {&#xA;            alert(&quot;Задача отменена&quot;);&#xA;     setTimeout(&quot;history.go(0);&quot;, 500);&#xA;&#xA;     mnuBar1.style.display = 'inline';&#xA;        }&#xA;        else&#xA;        {&#xA;            setTimeout(&quot;WaitWorkflowExecution('&quot; + workflowId + &quot;');&quot;, 1000);&#xA;        }&#xA;    }&#xA;}&#xA;&#xA;mnuBar1.style.display = 'none';&#xA;var theWorkflowId = &quot;b602db85-b557-4d1f-a133-add7ce5dc9e0&quot;;&#xA;var workflowInstanceId = ExecuteWorkflow(crmForm.ObjectId, theWorkflowId);&#xA;&#xA;setTimeout(&quot;WaitWorkflowExecution(workflowInstanceId);&quot;, 1000);&#xA;&#xA;" PassParams="1" WinParams="" WinMode="0">
              <Titles>
                <Title LCID="1049" Text="Отменить" />
              </Titles>
              <ToolTips>
                <ToolTip LCID="1049" Text="Отменить задачу" />
              </ToolTips>
            </Button>
          </ToolBar>
        </Entity>
        <Entity name="phonecall">
          <!-- The Account Tool Bar -->
          <ToolBar ValidForCreate="0" ValidForUpdate="1">
            <Button Icon="/_imgs/ico/16_deactivate.gif" JavaScript="&#xA;ExecuteWorkflow = function(entityId, workflowId)&#xA;{&#xA;    var xml = &quot;&quot; + &#xA;    &quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;utf-8\&quot;?&gt;&quot; + &#xA;    &quot;&lt;soap:Envelope xmlns:soap=\&quot;http://schemas.xmlsoap.org/soap/envelope/\&quot; xmlns:xsi=\&quot;http://www.w3.org/2001/XMLSchema-instance\&quot; xmlns:xsd=\&quot;http://www.w3.org/2001/XMLSchema\&quot;&gt;&quot; + &#xA;    GenerateAuthenticationHeader() +&#xA;    &quot;  &lt;soap:Body&gt;&quot; + &#xA;    &quot;    &lt;Execute xmlns=\&quot;http://schemas.microsoft.com/crm/2007/WebServices\&quot;&gt;&quot; + &#xA;    &quot;      &lt;Request xsi:type=\&quot;ExecuteWorkflowRequest\&quot;&gt;&quot; + &#xA;    &quot;        &lt;EntityId&gt;&quot; + entityId + &quot;&lt;/EntityId&gt;&quot; + &#xA;    &quot;        &lt;WorkflowId&gt;&quot; + workflowId + &quot;&lt;/WorkflowId&gt;&quot; + &#xA;    &quot;      &lt;/Request&gt;&quot; + &#xA;    &quot;    &lt;/Execute&gt;&quot; + &#xA;    &quot;  &lt;/soap:Body&gt;&quot; + &#xA;    &quot;&lt;/soap:Envelope&gt;&quot; + &#xA;    &quot;&quot;;&#xA;&#xA;    var xmlHttpRequest = new ActiveXObject(&quot;Msxml2.XMLHTTP&quot;);&#xA;    xmlHttpRequest.Open(&quot;POST&quot;, &quot;/mscrmservices/2007/CrmService.asmx&quot;, false);&#xA;    xmlHttpRequest.setRequestHeader(&quot;SOAPAction&quot;,&quot;http://schemas.microsoft.com/crm/2007/WebServices/Execute&quot;);&#xA;    xmlHttpRequest.setRequestHeader(&quot;Content-Type&quot;, &quot;text/xml; charset=utf-8&quot;);&#xA;    xmlHttpRequest.setRequestHeader(&quot;Content-Length&quot;, xml.length);&#xA;    xmlHttpRequest.send(xml);&#xA;    var resultXml = xmlHttpRequest.responseXML;&#xA;    return(resultXml.selectSingleNode('//soap:Envelope/soap:Body/ExecuteResponse/Response/Id').nodeTypedValue);&#xA;}&#xA;&#xA;WaitWorkflowExecution = function(workflowId)&#xA;{&#xA;    var xml = &quot;&lt;?xml version='1.0' encoding='utf-8'?&gt;&quot;+ &#xA;    &quot;&lt;soap:Envelope xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'&quot;+&#xA;    &quot; xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'&quot;+&#xA;    &quot; xmlns:xsd='http://www.w3.org/2001/XMLSchema'&gt;&quot;+ &#xA;    GenerateAuthenticationHeader() +&#xA;    &quot;&lt;soap:Body&gt;&quot;+ &#xA;    &quot;&lt;Retrieve xmlns='http://schemas.microsoft.com/crm/2007/WebServices'&gt;&quot;+ &#xA;    &quot;&lt;entityName&gt;asyncoperation&lt;/entityName&gt;&quot;+ &#xA;    &quot;&lt;id&gt;&quot;+workflowId+&quot;&lt;/id&gt;&quot;+ &#xA;    &quot;&lt;columnSet xmlns:q1='http://schemas.microsoft.com/crm/2006/Query' xsi:type='q1:ColumnSet'&gt;&quot;+ &#xA;    &quot;&lt;q1:Attributes&gt;&quot;+ &#xA;    &quot;&lt;q1:Attribute&gt;statuscode&lt;/q1:Attribute&gt;&quot;+ &#xA;    &quot;&lt;/q1:Attributes&gt;&quot;+ &#xA;    &quot;&lt;/columnSet&gt;&quot;+ &#xA;    &quot;&lt;/Retrieve&gt;&quot;+ &#xA;    &quot;&lt;/soap:Body&gt;&quot;+ &#xA;    &quot;&lt;/soap:Envelope&gt;&quot;;&#xA;&#xA;    var xHReq = new ActiveXObject(&quot;Msxml2.XMLHTTP&quot;);&#xA;    xHReq.Open(&quot;POST&quot;, &quot;/mscrmservices/2007/CrmService.asmx&quot;, false);&#xA;    xHReq.setRequestHeader(&quot;SOAPAction&quot;,&quot;http://schemas.microsoft.com/crm/2007/WebServices/Retrieve&quot;);&#xA;    xHReq.setRequestHeader(&quot;Content-Type&quot;, &quot;text/xml; charset=utf-8&quot;);&#xA;    xHReq.setRequestHeader(&quot;Content-Length&quot;, xml.length);&#xA;    xHReq.send(xml);&#xA;    var resultXml = xHReq.responseXML;&#xA;&#xA;    var errorCount = resultXml.selectNodes('//error').length;&#xA;    if (errorCount != 0)&#xA;    {&#xA; // alert(xHReq.responseText + xHReq.status + xHReq.statusText);&#xA;        setTimeout(&quot;WaitWorkflowExecution('&quot; + workflowId + &quot;');&quot;, 1000);&#xA;    }&#xA;    else&#xA;    {&#xA;        var executionstatus = resultXml.selectSingleNode(&quot;//soap:Envelope/soap:Body/RetrieveResponse/RetrieveResult/q1:statuscode&quot;).nodeTypedValue;&#xA;    &#xA;&#xA;        if (executionstatus == 30)//Workflow completed&#xA;        {&#xA;            alert(&quot;Звонок отменен&quot;);&#xA;     setTimeout(&quot;history.go(0);&quot;, 500);&#xA;&#xA;     mnuBar1.style.display = 'inline';&#xA;        }&#xA;        else&#xA;        {&#xA;            setTimeout(&quot;WaitWorkflowExecution('&quot; + workflowId + &quot;');&quot;, 1000);&#xA;        }&#xA;    }&#xA;}&#xA;&#xA;mnuBar1.style.display = 'none';&#xA;var theWorkflowId = &quot;896FE288-167E-492B-91A4-27D9A4D66A14&quot;;&#xA;var workflowInstanceId = ExecuteWorkflow(crmForm.ObjectId, theWorkflowId);&#xA;&#xA;setTimeout(&quot;WaitWorkflowExecution(workflowInstanceId);&quot;, 1000);&#xA;&#xA;" PassParams="1" WinParams="" WinMode="0">
              <Titles>
                <Title LCID="1049" Text="Отменить" />
              </Titles>
              <ToolTips>
                <ToolTip LCID="1049" Text="Отменить звонок" />
              </ToolTips>
            </Button>
          </ToolBar>
        </Entity>
        <!-- The appointment Tool Bar -->
        <Entity name="appointment">
          <ToolBar ValidForCreate="0" ValidForUpdate="1">
            <Button Icon="/_imgs/ico/16_deactivate.gif" JavaScript="&#xA;ExecuteWorkflow = function(entityId, workflowId)&#xA;{&#xA;    var xml = &quot;&quot; + &#xA;    &quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;utf-8\&quot;?&gt;&quot; + &#xA;    &quot;&lt;soap:Envelope xmlns:soap=\&quot;http://schemas.xmlsoap.org/soap/envelope/\&quot; xmlns:xsi=\&quot;http://www.w3.org/2001/XMLSchema-instance\&quot; xmlns:xsd=\&quot;http://www.w3.org/2001/XMLSchema\&quot;&gt;&quot; + &#xA;    GenerateAuthenticationHeader() +&#xA;    &quot;  &lt;soap:Body&gt;&quot; + &#xA;    &quot;    &lt;Execute xmlns=\&quot;http://schemas.microsoft.com/crm/2007/WebServices\&quot;&gt;&quot; + &#xA;    &quot;      &lt;Request xsi:type=\&quot;ExecuteWorkflowRequest\&quot;&gt;&quot; + &#xA;    &quot;        &lt;EntityId&gt;&quot; + entityId + &quot;&lt;/EntityId&gt;&quot; + &#xA;    &quot;        &lt;WorkflowId&gt;&quot; + workflowId + &quot;&lt;/WorkflowId&gt;&quot; + &#xA;    &quot;      &lt;/Request&gt;&quot; + &#xA;    &quot;    &lt;/Execute&gt;&quot; + &#xA;    &quot;  &lt;/soap:Body&gt;&quot; + &#xA;    &quot;&lt;/soap:Envelope&gt;&quot; + &#xA;    &quot;&quot;;&#xA;&#xA;    var xmlHttpRequest = new ActiveXObject(&quot;Msxml2.XMLHTTP&quot;);&#xA;    xmlHttpRequest.Open(&quot;POST&quot;, &quot;/mscrmservices/2007/CrmService.asmx&quot;, false);&#xA;    xmlHttpRequest.setRequestHeader(&quot;SOAPAction&quot;,&quot;http://schemas.microsoft.com/crm/2007/WebServices/Execute&quot;);&#xA;    xmlHttpRequest.setRequestHeader(&quot;Content-Type&quot;, &quot;text/xml; charset=utf-8&quot;);&#xA;    xmlHttpRequest.setRequestHeader(&quot;Content-Length&quot;, xml.length);&#xA;    xmlHttpRequest.send(xml);&#xA;    var resultXml = xmlHttpRequest.responseXML;&#xA;    return(resultXml.selectSingleNode('//soap:Envelope/soap:Body/ExecuteResponse/Response/Id').nodeTypedValue);&#xA;}&#xA;&#xA;WaitWorkflowExecution = function(workflowId)&#xA;{&#xA;    var xml = &quot;&lt;?xml version='1.0' encoding='utf-8'?&gt;&quot;+ &#xA;    &quot;&lt;soap:Envelope xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'&quot;+&#xA;    &quot; xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'&quot;+&#xA;    &quot; xmlns:xsd='http://www.w3.org/2001/XMLSchema'&gt;&quot;+ &#xA;    GenerateAuthenticationHeader() +&#xA;    &quot;&lt;soap:Body&gt;&quot;+ &#xA;    &quot;&lt;Retrieve xmlns='http://schemas.microsoft.com/crm/2007/WebServices'&gt;&quot;+ &#xA;    &quot;&lt;entityName&gt;asyncoperation&lt;/entityName&gt;&quot;+ &#xA;    &quot;&lt;id&gt;&quot;+workflowId+&quot;&lt;/id&gt;&quot;+ &#xA;    &quot;&lt;columnSet xmlns:q1='http://schemas.microsoft.com/crm/2006/Query' xsi:type='q1:ColumnSet'&gt;&quot;+ &#xA;    &quot;&lt;q1:Attributes&gt;&quot;+ &#xA;    &quot;&lt;q1:Attribute&gt;statuscode&lt;/q1:Attribute&gt;&quot;+ &#xA;    &quot;&lt;/q1:Attributes&gt;&quot;+ &#xA;    &quot;&lt;/columnSet&gt;&quot;+ &#xA;    &quot;&lt;/Retrieve&gt;&quot;+ &#xA;    &quot;&lt;/soap:Body&gt;&quot;+ &#xA;    &quot;&lt;/soap:Envelope&gt;&quot;;&#xA;&#xA;    var xHReq = new ActiveXObject(&quot;Msxml2.XMLHTTP&quot;);&#xA;    xHReq.Open(&quot;POST&quot;, &quot;/mscrmservices/2007/CrmService.asmx&quot;, false);&#xA;    xHReq.setRequestHeader(&quot;SOAPAction&quot;,&quot;http://schemas.microsoft.com/crm/2007/WebServices/Retrieve&quot;);&#xA;    xHReq.setRequestHeader(&quot;Content-Type&quot;, &quot;text/xml; charset=utf-8&quot;);&#xA;    xHReq.setRequestHeader(&quot;Content-Length&quot;, xml.length);&#xA;    xHReq.send(xml);&#xA;    var resultXml = xHReq.responseXML;&#xA;&#xA;    var errorCount = resultXml.selectNodes('//error').length;&#xA;    if (errorCount != 0)&#xA;    {&#xA; // alert(xHReq.responseText + xHReq.status + xHReq.statusText);&#xA;        setTimeout(&quot;WaitWorkflowExecution('&quot; + workflowId + &quot;');&quot;, 1000);&#xA;    }&#xA;    else&#xA;    {&#xA;        var executionstatus = resultXml.selectSingleNode(&quot;//soap:Envelope/soap:Body/RetrieveResponse/RetrieveResult/q1:statuscode&quot;).nodeTypedValue;&#xA;    &#xA;&#xA;        if (executionstatus == 30)//Workflow completed&#xA;        {&#xA;            alert(&quot;Встреча отменена&quot;);&#xA;     setTimeout(&quot;history.go(0);&quot;, 500);&#xA;&#xA;     mnuBar1.style.display = 'inline';&#xA;        }&#xA;        else&#xA;        {&#xA;            setTimeout(&quot;WaitWorkflowExecution('&quot; + workflowId + &quot;');&quot;, 1000);&#xA;        }&#xA;    }&#xA;}&#xA;&#xA;mnuBar1.style.display = 'none';&#xA;var theWorkflowId = &quot;ac584733-f5a4-4c2a-affa-409b492ae519&quot;;&#xA;var workflowInstanceId = ExecuteWorkflow(crmForm.ObjectId, theWorkflowId);&#xA;&#xA;setTimeout(&quot;WaitWorkflowExecution(workflowInstanceId);&quot;, 1000);&#xA;&#xA;" PassParams="1" WinParams="" WinMode="0">
              <Titles>
                <Title LCID="1049" Text="Отменить" />
              </Titles>
              <ToolTips>
                <ToolTip LCID="1049" Text="Отменить встречу" />
              </ToolTips>
            </Button>
          </ToolBar>
        </Entity>
        <Entity name="phonecall">
          <!-- The Account Tool Bar -->
          <ToolBar ValidForCreate="0" ValidForUpdate="1">
            <Button Icon="/_imgs/ico/16_deactivate.gif" JavaScript="&#xA;ExecuteWorkflow = function(entityId, workflowId)&#xA;{&#xA;    var xml = &quot;&quot; + &#xA;    &quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;utf-8\&quot;?&gt;&quot; + &#xA;    &quot;&lt;soap:Envelope xmlns:soap=\&quot;http://schemas.xmlsoap.org/soap/envelope/\&quot; xmlns:xsi=\&quot;http://www.w3.org/2001/XMLSchema-instance\&quot; xmlns:xsd=\&quot;http://www.w3.org/2001/XMLSchema\&quot;&gt;&quot; + &#xA;    GenerateAuthenticationHeader() +&#xA;    &quot;  &lt;soap:Body&gt;&quot; + &#xA;    &quot;    &lt;Execute xmlns=\&quot;http://schemas.microsoft.com/crm/2007/WebServices\&quot;&gt;&quot; + &#xA;    &quot;      &lt;Request xsi:type=\&quot;ExecuteWorkflowRequest\&quot;&gt;&quot; + &#xA;    &quot;        &lt;EntityId&gt;&quot; + entityId + &quot;&lt;/EntityId&gt;&quot; + &#xA;    &quot;        &lt;WorkflowId&gt;&quot; + workflowId + &quot;&lt;/WorkflowId&gt;&quot; + &#xA;    &quot;      &lt;/Request&gt;&quot; + &#xA;    &quot;    &lt;/Execute&gt;&quot; + &#xA;    &quot;  &lt;/soap:Body&gt;&quot; + &#xA;    &quot;&lt;/soap:Envelope&gt;&quot; + &#xA;    &quot;&quot;;&#xA;&#xA;    var xmlHttpRequest = new ActiveXObject(&quot;Msxml2.XMLHTTP&quot;);&#xA;    xmlHttpRequest.Open(&quot;POST&quot;, &quot;/mscrmservices/2007/CrmService.asmx&quot;, false);&#xA;    xmlHttpRequest.setRequestHeader(&quot;SOAPAction&quot;,&quot;http://schemas.microsoft.com/crm/2007/WebServices/Execute&quot;);&#xA;    xmlHttpRequest.setRequestHeader(&quot;Content-Type&quot;, &quot;text/xml; charset=utf-8&quot;);&#xA;    xmlHttpRequest.setRequestHeader(&quot;Content-Length&quot;, xml.length);&#xA;    xmlHttpRequest.send(xml);&#xA;    var resultXml = xmlHttpRequest.responseXML;&#xA;    return(resultXml.selectSingleNode('//soap:Envelope/soap:Body/ExecuteResponse/Response/Id').nodeTypedValue);&#xA;}&#xA;&#xA;WaitWorkflowExecution = function(workflowId)&#xA;{&#xA;    var xml = &quot;&lt;?xml version='1.0' encoding='utf-8'?&gt;&quot;+ &#xA;    &quot;&lt;soap:Envelope xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'&quot;+&#xA;    &quot; xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'&quot;+&#xA;    &quot; xmlns:xsd='http://www.w3.org/2001/XMLSchema'&gt;&quot;+ &#xA;    GenerateAuthenticationHeader() +&#xA;    &quot;&lt;soap:Body&gt;&quot;+ &#xA;    &quot;&lt;Retrieve xmlns='http://schemas.microsoft.com/crm/2007/WebServices'&gt;&quot;+ &#xA;    &quot;&lt;entityName&gt;asyncoperation&lt;/entityName&gt;&quot;+ &#xA;    &quot;&lt;id&gt;&quot;+workflowId+&quot;&lt;/id&gt;&quot;+ &#xA;    &quot;&lt;columnSet xmlns:q1='http://schemas.microsoft.com/crm/2006/Query' xsi:type='q1:ColumnSet'&gt;&quot;+ &#xA;    &quot;&lt;q1:Attributes&gt;&quot;+ &#xA;    &quot;&lt;q1:Attribute&gt;statuscode&lt;/q1:Attribute&gt;&quot;+ &#xA;    &quot;&lt;/q1:Attributes&gt;&quot;+ &#xA;    &quot;&lt;/columnSet&gt;&quot;+ &#xA;    &quot;&lt;/Retrieve&gt;&quot;+ &#xA;    &quot;&lt;/soap:Body&gt;&quot;+ &#xA;    &quot;&lt;/soap:Envelope&gt;&quot;;&#xA;&#xA;    var xHReq = new ActiveXObject(&quot;Msxml2.XMLHTTP&quot;);&#xA;    xHReq.Open(&quot;POST&quot;, &quot;/mscrmservices/2007/CrmService.asmx&quot;, false);&#xA;    xHReq.setRequestHeader(&quot;SOAPAction&quot;,&quot;http://schemas.microsoft.com/crm/2007/WebServices/Retrieve&quot;);&#xA;    xHReq.setRequestHeader(&quot;Content-Type&quot;, &quot;text/xml; charset=utf-8&quot;);&#xA;    xHReq.setRequestHeader(&quot;Content-Length&quot;, xml.length);&#xA;    xHReq.send(xml);&#xA;    var resultXml = xHReq.responseXML;&#xA;&#xA;    var errorCount = resultXml.selectNodes('//error').length;&#xA;    if (errorCount != 0)&#xA;    {&#xA; // alert(xHReq.responseText + xHReq.status + xHReq.statusText);&#xA;        setTimeout(&quot;WaitWorkflowExecution('&quot; + workflowId + &quot;');&quot;, 1000);&#xA;    }&#xA;    else&#xA;    {&#xA;        var executionstatus = resultXml.selectSingleNode(&quot;//soap:Envelope/soap:Body/RetrieveResponse/RetrieveResult/q1:statuscode&quot;).nodeTypedValue;&#xA;    &#xA;&#xA;        if (executionstatus == 30)//Workflow completed&#xA;        {&#xA;            alert(&quot;Звонок отменен&quot;);&#xA;     setTimeout(&quot;history.go(0);&quot;, 500);&#xA;&#xA;     mnuBar1.style.display = 'inline';&#xA;        }&#xA;        else&#xA;        {&#xA;            setTimeout(&quot;WaitWorkflowExecution('&quot; + workflowId + &quot;');&quot;, 1000);&#xA;        }&#xA;    }&#xA;}&#xA;&#xA;mnuBar1.style.display = 'none';&#xA;var theWorkflowId = &quot;896FE288-167E-492B-91A4-27D9A4D66A14&quot;;&#xA;var workflowInstanceId = ExecuteWorkflow(crmForm.ObjectId, theWorkflowId);&#xA;&#xA;setTimeout(&quot;WaitWorkflowExecution(workflowInstanceId);&quot;, 1000);&#xA;&#xA;" PassParams="1" WinParams="" WinMode="0">
              <Titles>
                <Title LCID="1049" Text="Отменить" />
              </Titles>
              <ToolTips>
                <ToolTip LCID="1049" Text="Отменить звонок" />
              </ToolTips>
            </Button>
          </ToolBar>
        </Entity>
        <!-- The letter Tool Bar -->
        <Entity name="letter">
          <ToolBar ValidForCreate="0" ValidForUpdate="1">
            <Button Icon="/_imgs/ico/16_deactivate.gif" JavaScript="&#xA;ExecuteWorkflow = function(entityId, workflowId)&#xA;{&#xA;    var xml = &quot;&quot; + &#xA;    &quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;utf-8\&quot;?&gt;&quot; + &#xA;    &quot;&lt;soap:Envelope xmlns:soap=\&quot;http://schemas.xmlsoap.org/soap/envelope/\&quot; xmlns:xsi=\&quot;http://www.w3.org/2001/XMLSchema-instance\&quot; xmlns:xsd=\&quot;http://www.w3.org/2001/XMLSchema\&quot;&gt;&quot; + &#xA;    GenerateAuthenticationHeader() +&#xA;    &quot;  &lt;soap:Body&gt;&quot; + &#xA;    &quot;    &lt;Execute xmlns=\&quot;http://schemas.microsoft.com/crm/2007/WebServices\&quot;&gt;&quot; + &#xA;    &quot;      &lt;Request xsi:type=\&quot;ExecuteWorkflowRequest\&quot;&gt;&quot; + &#xA;    &quot;        &lt;EntityId&gt;&quot; + entityId + &quot;&lt;/EntityId&gt;&quot; + &#xA;    &quot;        &lt;WorkflowId&gt;&quot; + workflowId + &quot;&lt;/WorkflowId&gt;&quot; + &#xA;    &quot;      &lt;/Request&gt;&quot; + &#xA;    &quot;    &lt;/Execute&gt;&quot; + &#xA;    &quot;  &lt;/soap:Body&gt;&quot; + &#xA;    &quot;&lt;/soap:Envelope&gt;&quot; + &#xA;    &quot;&quot;;&#xA;&#xA;    var xmlHttpRequest = new ActiveXObject(&quot;Msxml2.XMLHTTP&quot;);&#xA;    xmlHttpRequest.Open(&quot;POST&quot;, &quot;/mscrmservices/2007/CrmService.asmx&quot;, false);&#xA;    xmlHttpRequest.setRequestHeader(&quot;SOAPAction&quot;,&quot;http://schemas.microsoft.com/crm/2007/WebServices/Execute&quot;);&#xA;    xmlHttpRequest.setRequestHeader(&quot;Content-Type&quot;, &quot;text/xml; charset=utf-8&quot;);&#xA;    xmlHttpRequest.setRequestHeader(&quot;Content-Length&quot;, xml.length);&#xA;    xmlHttpRequest.send(xml);&#xA;    var resultXml = xmlHttpRequest.responseXML;&#xA;    return(resultXml.selectSingleNode('//soap:Envelope/soap:Body/ExecuteResponse/Response/Id').nodeTypedValue);&#xA;}&#xA;&#xA;WaitWorkflowExecution = function(workflowId)&#xA;{&#xA;    var xml = &quot;&lt;?xml version='1.0' encoding='utf-8'?&gt;&quot;+ &#xA;    &quot;&lt;soap:Envelope xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'&quot;+&#xA;    &quot; xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'&quot;+&#xA;    &quot; xmlns:xsd='http://www.w3.org/2001/XMLSchema'&gt;&quot;+ &#xA;    GenerateAuthenticationHeader() +&#xA;    &quot;&lt;soap:Body&gt;&quot;+ &#xA;    &quot;&lt;Retrieve xmlns='http://schemas.microsoft.com/crm/2007/WebServices'&gt;&quot;+ &#xA;    &quot;&lt;entityName&gt;asyncoperation&lt;/entityName&gt;&quot;+ &#xA;    &quot;&lt;id&gt;&quot;+workflowId+&quot;&lt;/id&gt;&quot;+ &#xA;    &quot;&lt;columnSet xmlns:q1='http://schemas.microsoft.com/crm/2006/Query' xsi:type='q1:ColumnSet'&gt;&quot;+ &#xA;    &quot;&lt;q1:Attributes&gt;&quot;+ &#xA;    &quot;&lt;q1:Attribute&gt;statuscode&lt;/q1:Attribute&gt;&quot;+ &#xA;    &quot;&lt;/q1:Attributes&gt;&quot;+ &#xA;    &quot;&lt;/columnSet&gt;&quot;+ &#xA;    &quot;&lt;/Retrieve&gt;&quot;+ &#xA;    &quot;&lt;/soap:Body&gt;&quot;+ &#xA;    &quot;&lt;/soap:Envelope&gt;&quot;;&#xA;&#xA;    var xHReq = new ActiveXObject(&quot;Msxml2.XMLHTTP&quot;);&#xA;    xHReq.Open(&quot;POST&quot;, &quot;/mscrmservices/2007/CrmService.asmx&quot;, false);&#xA;    xHReq.setRequestHeader(&quot;SOAPAction&quot;,&quot;http://schemas.microsoft.com/crm/2007/WebServices/Retrieve&quot;);&#xA;    xHReq.setRequestHeader(&quot;Content-Type&quot;, &quot;text/xml; charset=utf-8&quot;);&#xA;    xHReq.setRequestHeader(&quot;Content-Length&quot;, xml.length);&#xA;    xHReq.send(xml);&#xA;    var resultXml = xHReq.responseXML;&#xA;&#xA;    var errorCount = resultXml.selectNodes('//error').length;&#xA;    if (errorCount != 0)&#xA;    {&#xA; // alert(xHReq.responseText + xHReq.status + xHReq.statusText);&#xA;        setTimeout(&quot;WaitWorkflowExecution('&quot; + workflowId + &quot;');&quot;, 1000);&#xA;    }&#xA;    else&#xA;    {&#xA;        var executionstatus = resultXml.selectSingleNode(&quot;//soap:Envelope/soap:Body/RetrieveResponse/RetrieveResult/q1:statuscode&quot;).nodeTypedValue;&#xA;    &#xA;&#xA;        if (executionstatus == 30)//Workflow completed&#xA;        {&#xA;            alert(&quot;Письмо отменено&quot;);&#xA;     setTimeout(&quot;history.go(0);&quot;, 500);&#xA;&#xA;     mnuBar1.style.display = 'inline';&#xA;        }&#xA;        else&#xA;        {&#xA;            setTimeout(&quot;WaitWorkflowExecution('&quot; + workflowId + &quot;');&quot;, 1000);&#xA;        }&#xA;    }&#xA;}&#xA;&#xA;mnuBar1.style.display = 'none';&#xA;var theWorkflowId = &quot;220145cb-2ba8-483b-aa0a-dc4991dcaef2&quot;;&#xA;var workflowInstanceId = ExecuteWorkflow(crmForm.ObjectId, theWorkflowId);&#xA;&#xA;setTimeout(&quot;WaitWorkflowExecution(workflowInstanceId);&quot;, 1000);&#xA;&#xA;" PassParams="1" WinParams="" WinMode="0">
              <Titles>
                <Title LCID="1049" Text="Отменить" />
              </Titles>
              <ToolTips>
                <ToolTip LCID="1049" Text="Отменить письмо" />
              </ToolTips>
            </Button>
          </ToolBar>
        </Entity>
        <!-- End Custom Entities -->
      </Entities>
      <!-- Microsoft Customer Relationship Management Service Management Customization -->
      <ServiceManagement>
        <AppointmentBook>
          <SmoothScrollLimit>2000</SmoothScrollLimit>
          <TimeBlocks>
            <!-- All CSS Class mapping for Service activities -->
            <TimeBlock EntityType="4214" StatusCode="1" CssClass="ganttBlockServiceActivityStatus1" />
            <TimeBlock EntityType="4214" StatusCode="2" CssClass="ganttBlockServiceActivityStatus2" />
            <TimeBlock EntityType="4214" StatusCode="3" CssClass="ganttBlockServiceActivityStatus3" />
            <TimeBlock EntityType="4214" StatusCode="4" CssClass="ganttBlockServiceActivityStatus4" />
            <TimeBlock EntityType="4214" StatusCode="6" CssClass="ganttBlockServiceActivityStatus6" />
            <TimeBlock EntityType="4214" StatusCode="7" CssClass="ganttBlockServiceActivityStatus7" />
            <TimeBlock EntityType="4214" StatusCode="8" CssClass="ganttBlockServiceActivityStatus8" />
            <TimeBlock EntityType="4214" StatusCode="9" CssClass="ganttBlockServiceActivityStatus9" />
            <TimeBlock EntityType="4214" StatusCode="10" CssClass="ganttBlockServiceActivityStatus10" />
            <!-- All CSS Class mapping for Appointments -->
            <TimeBlock EntityType="4201" StatusCode="1" CssClass="ganttBlockAppointmentStatus1" />
            <TimeBlock EntityType="4201" StatusCode="2" CssClass="ganttBlockAppointmentStatus2" />
            <TimeBlock EntityType="4201" StatusCode="3" CssClass="ganttBlockAppointmentStatus3" />
            <TimeBlock EntityType="4201" StatusCode="4" CssClass="ganttBlockAppointmentStatus4" />
            <TimeBlock EntityType="4201" StatusCode="5" CssClass="ganttBlockAppointmentStatus5" />
            <TimeBlock EntityType="4201" StatusCode="6" CssClass="ganttBlockAppointmentStatus6" />
          </TimeBlocks>
        </AppointmentBook>
      </ServiceManagement>
    </configuration>
  </IsvConfig>
  <EntityMaps />
  <EntityRelationships />
  <Languages>
    <Language>1049</Language>
  </Languages>
</ImportExportXml>