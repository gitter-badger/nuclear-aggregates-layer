@using BLCore.UI.Web.Mvc.Utils
@model Models.CyprusAccountViewModel

@{
    Layout = "../Shared/_CardLayout.cshtml";
}

@section CardScripts
{
    <style type="text/css">
        div.label-wrapper
        {
            width: 180px !important;
        }
    </style>
    
    
    <script type="text/javascript">
        window.InitPage = function () {

            window.Card.on("afterbuild", function (card) {
                if (window.Ext.getDom("ViewConfig_Id").value && window.Ext.getDom("ViewConfig_Id").value != "0") {
                    this.Items.TabPanel.add(
                        {
                            xtype: "actionshistorytab",
                            pCardInfo:
                            {
                                pTypeId: this.Settings.EntityId,
                                pId: window.Ext.getDom("ViewConfig_Id").value,
                                pTypeName: Ext.get("ViewConfig_EntityName").dom.value
                            }
                        });
                }
            });
        };
    </script>

}

@section CardBody
{
<div class="Tab" id="MainTab" title="@BLResources.GeneralTabTitle">
    @Html.HiddenFor(m => m.Id)

    @{
        var readonlyFieldHtmlAttributes = new Dictionary<string, object> { { "class", "readonly inputfields" }, { "readonly", "readonly" } };
    }
       
    <div class="row-wrapper">
        @Html.TemplateField(m => m.LegalPerson, FieldFlex.lone, new LookupSettings { EntityName = EntityName.LegalPerson, ReadOnly = !Model.IsNew && !string.IsNullOrEmpty(Model.LegalPerson.Value) })
    </div>
    <div class="row-wrapper">
        @Html.TemplateField(m => m.BranchOfficeOrganizationUnit, FieldFlex.lone, new LookupSettings { EntityName = EntityName.BranchOfficeOrganizationUnit, ReadOnly = !Model.IsNew && !string.IsNullOrEmpty(Model.BranchOfficeOrganizationUnit.Value) })
    </div>
    <div class="row-wrapper">
        @Html.TemplateField(m => m.AccountDetailBalance, FieldFlex.twins, readonlyFieldHtmlAttributes)
        @Html.TemplateField(m => m.Currency, FieldFlex.twins, new LookupSettings { EntityName = EntityName.Currency, ReadOnly = true })
    </div>
    <div class="row-wrapper">
        @Html.TemplateField(m => m.LockDetailBalance, FieldFlex.twins, readonlyFieldHtmlAttributes)
        @Html.TemplateField(m => m.LegalPesonSyncCode1C, FieldFlex.twins, readonlyFieldHtmlAttributes)
    </div>
</div>
<div class="Tab" id="AdministrationTab" title="@BLResources.AdministrationTabTitle">
    @Html.SectionHead("adminHeader", BLResources.AdministrationTabTitle)
    @if (Model.IsCurated && Model.IsSecurityRoot)
    {
    <div class="row-wrapper">
        @Html.TemplateField(m=>m.Owner, FieldFlex.twins, new LookupSettings{EntityName = EntityName.User, Disabled = !Model.OwnerCanBeChanged, Plugins = new[] { "new Ext.ux.LookupFieldOwner()" } })
    </div>
    }
    
    <div class="row-wrapper">
        @Html.TemplateField(m=>m.CreatedBy, FieldFlex.twins, new LookupSettings{EntityName = EntityName.User, ReadOnly = true})
        @Html.TemplateField(m => m.CreatedOn, FieldFlex.twins, new DateTimeSettings { ReadOnly = true })
    </div>
    <div class="row-wrapper">
        @Html.TemplateField(m => m.ModifiedBy, FieldFlex.twins, new LookupSettings { EntityName = EntityName.User, ReadOnly = true })
        @Html.TemplateField(m => m.ModifiedOn, FieldFlex.twins, new DateTimeSettings { ReadOnly = true })
    </div>
</div>   
}