using DoubleGis.Erm.Platform.Migration.Base;
using DoubleGis.Erm.Platform.Migration.Core;

namespace DoubleGis.Erm.DB.Migration.Impl._0._18
{
    [Migration(9095, "Создаем заглушки")]
    public sealed class Migration9095 : TransactedMigration
    {
        protected override void ApplyOverride(IMigrationContext context)
        {
            const string Query = @"
DECLARE @CurrentAdvertisementTemplateId BIGINT
DECLARE @CurrentAdvertisementElementTemplateId BIGINT
DECLARE @AdsTemplatesAdsElementTemplatesId BIGINT
DECLARE @CurrentAdvertisementId BIGINT
DECLARE @CurrentAdvertisementElementId BIGINT

DECLARE @AdvertisementIds table(Id BIGINT NOT NULL);
INSERT INTO @AdvertisementIds Values
(159642090685333504),
(159642090685333760),
(159642090685334016),
(159642090685334272),
(159642090685334528),
(159642090685334784),
(159642090685335040),
(159642090685335296),
(159642090685335552),
(159642090685335808),
(159642090685336064),
(159642090685336320),
(159642090685336576),
(159642090685336832),
(159642090685337088),
(159642090685337344),
(159642090685337600),
(159642090685337856),
(159642090685338112),
(159642090685338368),
(159642090685338624),
(159642090685338880),
(159642090685339136),
(159642090685339392),
(159642090685339648),
(159642090685339904),
(159642090685340160),
(159642090685340416),
(159642090685340672),
(159642090685340928),
(159642090685341184),
(159642090685341440),
(159642090685341696),
(159642090685341952),
(159642090685342208),
(159642090685342464),
(159642090685342720),
(159642090685342976),
(159642090685343232),
(159642090685343488),
(159642090685343744),
(159642090685344000),
(159642090685344256),
(159642090685344512),
(159642090685344768),
(159642090685345024),
(159642090685345280),
(159642090685345536),
(159642090685345792),
(159642090685346048),
(159642090685346304),
(159642090685346560),
(159642090685346816),
(159642090685347072),
(159642090685347328),
(159642090685347584),
(159642090685347840),
(159642090685348096),
(159642090685348352),
(159642090685348608),
(159642090685348864),
(159642090685349120),
(159642090685349376),
(159642090685349632),
(159642090685349888),
(159642090685350144),
(159642090685350400),
(159642090685350656),
(159642090685350912),
(159642090685351168),
(159642090685351424),
(159642090685351680),
(159642090685351936),
(159642090685352192),
(159642090685352448),
(159642090685352704),
(159642090685352960),
(159642090685353216),
(159642090685353472),
(159642090685353728),
(159642090685353984),
(159642090685354240),
(159642090685354496),
(159642090685354752),
(159642090685355008),
(159642090685355264),
(159642090685355520),
(159642090685355776),
(159642090685356032),
(159642090685356288),
(159642090685356544),
(159642090685356800),
(159642090685357056),
(159642090685357312),
(159642090685357568),
(159642090685357824),
(159642090685358080),
(159642090685358336),
(159642090685358592),
(159642090685358848),
(159642090685359104),
(159642090685359360),
(159642090685359616),
(159642090685359872),
(159642090685360128),
(159642090685360384),
(159642090685360640),
(159642090685360896),
(159642090685361152),
(159642090685361408),
(159642090685361664),
(159642090685361920),
(159642090685362176),
(159642090685362432),
(159642090685362688),
(159642090685362944),
(159642090685363200),
(159642090685363456),
(159642090685363712),
(159642090685363968),
(159642090685364224),
(159642090685364480),
(159642090685364736),
(159642090685364992),
(159642090685365248),
(159642090685365504),
(159642090685365760),
(159642090685366016),
(159642090685366272),
(159642090685366528),
(159642090685366784),
(159642090685367040),
(159642090685367296),
(159642090685367552),
(159642090685367808),
(159642090685368064),
(159642090685368320),
(159642090685368576),
(159642090685368832),
(159642090685369088),
(159642090685369344),
(159642090685369600),
(159642090685369856),
(159642090685370112),
(159642090685370368),
(159642090685370624),
(159642090685370880),
(159642090685371136),
(159642090685371392),
(159642090685371648),
(159642090685371904),
(159642090685372160),
(159642090685372416),
(159642090685372672),
(159642090685372928),
(159642090685373184),
(159642090685373440),
(159642090685373696),
(159642090685373952),
(159642090685374208),
(159642090685374464),
(159642090685374720),
(159642090685374976),
(159642090685375232),
(159642090685375488),
(159642090685375744),
(159642090685376000),
(159642090685376256),
(159642090685376512),
(159642090685376768),
(159642090685377024),
(159642090685377280),
(159642090685377536),
(159642090685377792),
(159642090685378048),
(159642090685378304),
(159642090685378560),
(159642090685378816),
(159642090685379072),
(159642090685379328),
(159642090685379584),
(159642090685379840),
(159642090685380096),
(159642090685380352),
(159642090685380608),
(159642090685380864),
(159642090685381120),
(159642090685381376),
(159642090685381632),
(159642090685381888),
(159642090685382144),
(159642090685382400),
(159642090685382656),
(159642090685382912),
(159642090685383168),
(159642090685383424),
(159642090685383680),
(159642090685383936),
(159642090685384192),
(159642090685384448),
(159642090685384704),
(159642090685384960),
(159642090685385216),
(159642090685385472),
(159642090685385728),
(159642090685385984),
(159642090685386240),
(159642090685386496),
(159642090685386752),
(159642090685387008),
(159642090685387264),
(159642090685387520),
(159642090685387776),
(159642090685388032),
(159642090685388288),
(159642090685388544),
(159642090685388800),
(159642090685389056),
(159642090685389312),
(159642090685389568),
(159642090685389824),
(159642090685390080),
(159642090685390336),
(159642090685390592),
(159642090685390848),
(159642090685391104),
(159642090685391360),
(159642090685391616),
(159642090685391872),
(159642090685392128),
(159642090685392384),
(159642090685392640),
(159642090685392896),
(159642090685393152),
(159642090685393408),
(159642090685393664),
(159642090685393920),
(159642090685394176),
(159642090685394432),
(159642090685394688),
(159642090685394944),
(159642090685395200),
(159642090685395456),
(159642090685395712),
(159642090685395968),
(159642090685396224),
(159642090685396480),
(159642090685396736),
(159642090685396992),
(159642090685397248),
(159642090685397504),
(159642090685397760),
(159642090685398016),
(159642090685398272),
(159642090685398528),
(159642090685398784),
(159642090685399040),
(159642090685399296),
(159642090685399552),
(159642090685399808),
(159642090685400064),
(159642090685400320),
(159642090685400576),
(159642090685400832),
(159642090685401088),
(159642090685401344),
(159642090685401600),
(159642090685401856),
(159642090685402112),
(159642090685402368),
(159642090685402624),
(159642090685402880),
(159642090685403136),
(159642090685403392),
(159642090685403648),
(159642090685403904),
(159642090685404160),
(159642090685404416),
(159642090685404672),
(159642090685404928),
(159642090685405184),
(159642090685405440),
(159642090685405696),
(159642090685405952),
(159642090685406208),
(159642090685406464),
(159642090685406720),
(159642090685406976),
(159642090685407232),
(159642090685407488),
(159642090685407744),
(159642090685408000),
(159642090685408256),
(159642090685408512),
(159642090685408768),
(159642090685409024),
(159642090685409280),
(159642090685409536),
(159642090685409792),
(159642090685410048),
(159642090685410304),
(159642090685410560),
(159642090685410816),
(159642090685411072),
(159642090685411328),
(159642090685411584),
(159642090685411840),
(159642090685412096),
(159642090685412352),
(159642090685412608),
(159642090685412864),
(159642090685413120),
(159642090685413376),
(159642090685413632),
(159642090685413888),
(159642090685414144),
(159642090685414400),
(159642090685414656),
(159642090685414912),
(159642090685415168),
(159642090685415424),
(159642090685415680),
(159642090685415936),
(159642090685416192),
(159642090685416448),
(159642090685416704),
(159642090685416960),
(159642090685417216),
(159642090685417472),
(159642090685417728),
(159642090685417984),
(159642090685418240),
(159642090685418496),
(159642090685418752),
(159642090685419008),
(159642090685419264),
(159642090685419520),
(159642090685419776),
(159642090685420032),
(159642090685420288),
(159642090685420544),
(159642090685420800),
(159642090685421056),
(159642090685421312),
(159642090685421568),
(159642090685421824),
(159642090685422080),
(159642090685422336),
(159642090685422592),
(159642090685422848),
(159642090685423104),
(159642090685423360),
(159642090685423616),
(159642090685423872),
(159642090685424128),
(159642090685424384),
(159642090685424640),
(159642090685424896),
(159642090685425152),
(159642090685425408),
(159642090685425664),
(159642090685425920),
(159642090685426176),
(159642090685426432),
(159642090685426688),
(159642090685426944),
(159642090685427200),
(159642090685427456),
(159642090685427712),
(159642090685427968),
(159642090685428224),
(159642090685428480),
(159642090685428736),
(159642090685428992),
(159642090685429248),
(159642090685429504),
(159642090685429760),
(159642090685430016),
(159642090685430272),
(159642090685430528),
(159642090685430784),
(159642090685431040),
(159642090685431296),
(159642090685431552),
(159642090685431808),
(159642090685432064),
(159642090685432320),
(159642090685432576),
(159642090685432832),
(159642090685433088),
(159642090685433344),
(159642090685433600),
(159642090685433856),
(159642090685434112),
(159642090685434368),
(159642090685434624),
(159642090685434880),
(159642090685435136),
(159642090685435392),
(159642090685435648)

DECLARE @AdvertisementElementIds table(Id BIGINT NOT NULL);
INSERT INTO @AdvertisementElementIds Values
(159661801296990208),
(159661801296990464),
(159661801296990720),
(159661801296990976),
(159661801296991232),
(159661801296991488),
(159661801296991744),
(159661801296992000),
(159661801296992256),
(159661801296992512),
(159661801296992768),
(159661801296993024),
(159661801296993280),
(159661801296993536),
(159661801296993792),
(159661801296994048),
(159661801296994304),
(159661801296994560),
(159661801296994816),
(159661801296995072),
(159661801296995328),
(159661801296995584),
(159661801296995840),
(159661801296996096),
(159661801296996352),
(159661801296996608),
(159661801296996864),
(159661801296997120),
(159661801296997376),
(159661801296997632),
(159661801296997888),
(159661801296998144),
(159661801296998400),
(159661801296998656),
(159661801296998912),
(159661801296999168),
(159661801296999424),
(159661801296999680),
(159661801296999936),
(159661801297000192),
(159661801297000448),
(159661801297000704),
(159661801297000960),
(159661801297001216),
(159661801297001472),
(159661801297001728),
(159661801297001984),
(159661801297002240),
(159661801297002496),
(159661801297002752),
(159661801297003008),
(159661801297003264),
(159661801297003520),
(159661801297003776),
(159661801297004032),
(159661801297004288),
(159661801297004544),
(159661801297004800),
(159661801297005056),
(159661801297005312),
(159661801297005568),
(159661801297005824),
(159661801297006080),
(159661801297006336),
(159661801297006592),
(159661801297006848),
(159661801297007104),
(159661801297007360),
(159661801297007616),
(159661801297007872),
(159661801297008128),
(159661801297008384),
(159661801297008640),
(159661801297008896),
(159661801297009152),
(159661801297009408),
(159661801297009664),
(159661801297009920),
(159661801297010176),
(159661801297010432),
(159661801297010688),
(159661801297010944),
(159661801297011200),
(159661801297011456),
(159661801297011712),
(159661801297011968),
(159661801297012224),
(159661801297012480),
(159661801297012736),
(159661801297012992),
(159661801297013248),
(159661801297013504),
(159661801297013760),
(159661801297014016),
(159661801297014272),
(159661801297014528),
(159661801297014784),
(159661801297015040),
(159661801297015296),
(159661801297015552),
(159661801297015808),
(159661801297016064),
(159661801297016320),
(159661801297016576),
(159661801297016832),
(159661801297017088),
(159661801297017344),
(159661801297017600),
(159661801297017856),
(159661801297018112),
(159661801297018368),
(159661801297018624),
(159661801297018880),
(159661801297019136),
(159661801297019392),
(159661801297019648),
(159661801297019904),
(159661801297020160),
(159661801297020416),
(159661801297020672),
(159661801297020928),
(159661801297021184),
(159661801297021440),
(159661801297021696),
(159661801297021952),
(159661801297022208),
(159661801297022464),
(159661801297022720),
(159661801297022976),
(159661801297023232),
(159661801297023488),
(159661801297023744),
(159661801297024000),
(159661801297024256),
(159661801297024512),
(159661801297024768),
(159661801297025024),
(159661801297025280),
(159661801297025536),
(159661801297025792),
(159661801297026048),
(159661801297026304),
(159661801297026560),
(159661801297026816),
(159661801297027072),
(159661801297027328),
(159661801297027584),
(159661801297027840),
(159661801297028096),
(159661801297028352),
(159661801297028608),
(159661801297028864),
(159661801297029120),
(159661801297029376),
(159661801297029632),
(159661801297029888),
(159661801297030144),
(159661801297030400),
(159661801297030656),
(159661801297030912),
(159661801297031168),
(159661801297031424),
(159661801297031680),
(159661801297031936),
(159661801297032192),
(159661801297032448),
(159661801297032704),
(159661801297032960),
(159661801297033216),
(159661801297033472),
(159661801297033728),
(159661801297033984),
(159661801297034240),
(159661801297034496),
(159661801297034752),
(159661801297035008),
(159661801297035264),
(159661801297035520),
(159661801297035776),
(159661801297036032),
(159661801297036288),
(159661801297036544),
(159661801297036800),
(159661801297037056),
(159661801297037312),
(159661801297037568),
(159661801297037824),
(159661801297038080),
(159661801297038336),
(159661801297038592),
(159661801297038848),
(159661801297039104),
(159661801297039360),
(159661801297039616),
(159661801297039872),
(159661801297040128),
(159661801297040384),
(159661801297040640),
(159661801297040896),
(159661801297041152),
(159661801297041408),
(159661801297041664),
(159661801297041920),
(159661801297042176),
(159661801297042432),
(159661801297042688),
(159661801297042944),
(159661801297043200),
(159661801297043456),
(159661801297043712),
(159661801297043968),
(159661801297044224),
(159661801297044480),
(159661801297044736),
(159661801297044992),
(159661801297045248),
(159661801297045504),
(159661801297045760),
(159661801297046016),
(159661801297046272),
(159661801297046528),
(159661801297046784),
(159661801297047040),
(159661801297047296),
(159661801297047552),
(159661801297047808),
(159661801297048064),
(159661801297048320),
(159661801297048576),
(159661801297048832),
(159661801297049088),
(159661801297049344),
(159661801297049600),
(159661801297049856),
(159661801297050112),
(159661801297050368),
(159661801297050624),
(159661801297050880),
(159661801297051136),
(159661801297051392),
(159661801297051648),
(159661801297051904),
(159661801297052160),
(159661801297052416),
(159661801297052672),
(159661801297052928),
(159661801297053184),
(159661801297053440),
(159661801297053696),
(159661801297053952),
(159661801297054208),
(159661801297054464),
(159661801297054720),
(159661801297054976),
(159661801297055232),
(159661801297055488),
(159661801297055744),
(159661801297056000),
(159661801297056256),
(159661801297056512),
(159661801297056768),
(159661801297057024),
(159661801297057280),
(159661801297057536),
(159661801297057792),
(159661801297058048),
(159661801297058304),
(159661801297058560),
(159661801297058816),
(159661801297059072),
(159661801297059328),
(159661801297059584),
(159661801297059840),
(159661801297060096),
(159661801297060352),
(159661801297060608),
(159661801297060864),
(159661801297061120),
(159661801297061376),
(159661801297061632),
(159661801297061888),
(159661801297062144),
(159661801297062400),
(159661801297062656),
(159661801297062912),
(159661801297063168),
(159661801297063424),
(159661801297063680),
(159661801297063936),
(159661801297064192),
(159661801297064448),
(159661801297064704),
(159661801297064960),
(159661801297065216),
(159661801297065472),
(159661801297065728),
(159661801297065984),
(159661801297066240),
(159661801297066496),
(159661801297066752),
(159661801297067008),
(159661801297067264),
(159661801297067520),
(159661801297067776),
(159661801297068032),
(159661801297068288),
(159661801297068544),
(159661801297068800),
(159661801297069056),
(159661801297069312),
(159661801297069568),
(159661801297069824),
(159661801297070080),
(159661801297070336),
(159661801297070592),
(159661801297070848),
(159661801297071104),
(159661801297071360),
(159661801297071616),
(159661801297071872),
(159661801297072128),
(159661801297072384),
(159661801297072640),
(159661801297072896),
(159661801297073152),
(159661801297073408),
(159661801297073664),
(159661801297073920),
(159661801297074176),
(159661801297074432),
(159661801297074688),
(159661801297074944),
(159661801297075200),
(159661801297075456),
(159661801297075712),
(159661801297075968),
(159661801297076224),
(159661801297076480),
(159661801297076736),
(159661801297076992),
(159661801297077248),
(159661801297077504),
(159661801297077760),
(159661801297078016),
(159661801297078272),
(159661801297078528),
(159661801297078784),
(159661801297079040),
(159661801297079296),
(159661801297079552),
(159661801297079808),
(159661801297080064),
(159661801297080320),
(159661801297080576),
(159661801297080832),
(159661801297081088),
(159661801297081344),
(159661801297081600),
(159661801297081856),
(159661801297082112),
(159661801297082368),
(159661801297082624),
(159661801297082880),
(159661801297083136),
(159661801297083392),
(159661801297083648),
(159661801297083904),
(159661801297084160),
(159661801297084416),
(159661801297084672),
(159661801297084928),
(159661801297085184),
(159661801297085440),
(159661801297085696),
(159661801297085952),
(159661801297086208),
(159661801297086464),
(159661801297086720),
(159661801297086976),
(159661801297087232),
(159661801297087488),
(159661801297087744),
(159661801297088000),
(159661801297088256),
(159661801297088512),
(159661801297088768),
(159661801297089024),
(159661801297089280),
(159661801297089536),
(159661801297089792),
(159661801297090048),
(159661801297090304),
(159661801297090560),
(159661801297090816),
(159661801297091072),
(159661801297091328),
(159661801297091584),
(159661801297091840),
(159661801297092096),
(159661801297092352)

SET @CurrentAdvertisementTemplateId = (SELECT min(Id) FROM Billing.AdvertisementTemplates WHERE DummyAdvertisementId is null and IsDeleted = 0)
SET @CurrentAdvertisementId = (SELECT min(Id) FROM @AdvertisementIds)
SET @CurrentAdvertisementElementId = (SELECT min(Id) FROM @AdvertisementElementIds)

WHILE @CurrentAdvertisementTemplateId IS NOT NULL
BEGIN
    SET IDENTITY_INSERT Billing.Advertisements ON
    INSERT INTO Billing.Advertisements (Id, Name, AdvertisementTemplateId, IsSelectedToWhiteList, IsDeleted, OwnerCode, CreatedBy, CreatedOn, ModifiedBy, ModifiedOn) 
	    VALUES (@CurrentAdvertisementId, 'Заглушка', @CurrentAdvertisementTemplateId, 0, 0, 1, 1, GETUTCDATE(), 1, GETUTCDATE())
    SET IDENTITY_INSERT Billing.Advertisements OFF

	SET @CurrentAdvertisementElementTemplateId = (SELECT min(AdsElementTemplateId) FROM Billing.AdsTemplatesAdsElementTemplates WHERE AdsTemplateId = @CurrentAdvertisementTemplateId AND IsDeleted = 0)

    SET IDENTITY_INSERT Billing.AdvertisementElements ON
	WHILE @CurrentAdvertisementElementTemplateId IS NOT NULL
	BEGIN
		SET @AdsTemplatesAdsElementTemplatesId  = (SELECT TOP 1 Id  FROM Billing.AdsTemplatesAdsElementTemplates WHERE AdsElementTemplateId = @CurrentAdvertisementElementTemplateId AND AdsTemplateId = @CurrentAdvertisementTemplateId AND IsDeleted = 0)
        INSERT INTO Billing.AdvertisementElements (Id, AdvertisementId, AdvertisementElementTemplateId, AdsTemplatesAdsElementTemplatesId, IsDeleted, OwnerCode, CreatedBy, CreatedOn, ModifiedBy, ModifiedOn, FasCommentType) 
		    VALUES (@CurrentAdvertisementElementId, @CurrentAdvertisementId, @CurrentAdvertisementElementTemplateId, @AdsTemplatesAdsElementTemplatesId, 0, 1, 1, GETUTCDATE(), 1, GETUTCDATE(), 0)
        
		SET @CurrentAdvertisementElementTemplateId = (SELECT min(AdsElementTemplateId) FROM Billing.AdsTemplatesAdsElementTemplates WHERE AdsTemplateId = @CurrentAdvertisementTemplateId AND IsDeleted = 0 AND AdsElementTemplateId>@CurrentAdvertisementElementTemplateId)
        SET @CurrentAdvertisementElementId = (SELECT min(Id) FROM @AdvertisementElementIds WHERE Id>@CurrentAdvertisementElementId)
	END
SET IDENTITY_INSERT Billing.AdvertisementElements OFF

	UPDATE Billing.AdvertisementTemplates SET DummyAdvertisementId = @CurrentAdvertisementId  WHERE Id = @CurrentAdvertisementTemplateId

	SET @CurrentAdvertisementTemplateId = (SELECT min(Id) FROM Billing.AdvertisementTemplates WHERE DummyAdvertisementId is null and IsDeleted = 0 and id>@CurrentAdvertisementTemplateId)
    SET @CurrentAdvertisementId = (SELECT min(Id) FROM @AdvertisementIds WHERE id > @CurrentAdvertisementId)
END";

            context.Connection.ExecuteNonQuery(Query);
        }
    }
}
